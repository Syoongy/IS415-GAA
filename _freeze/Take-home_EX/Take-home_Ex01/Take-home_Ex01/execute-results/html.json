{
  "hash": "a84d48e06860165745e131fff945fd10",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-home Exercise 1: Armed Conflict in Myanmar\"\nauthor: \"Fan Syong Yue\"\ndate: 09/09/24\ndate-modified: \"last-modified\"\nexecute:\n  eval: true\n  echo: true\n  freeze: true\n---\n\n\n# Introduction\n\nMillions of people have their lives shattered by armed conflict – wars – every year.\n\nArmed conflict has been on the rise since about 2012, after a decline in the 1990s and early 2000s. First came conflicts in Libya, Syria and Yemen, triggered by the 2011 Arab uprisings. Libya’s instability spilled south, helping set off a protracted crisis in the Sahel region. A fresh wave of major combat followed: the 2020 Azerbaijani-Armenian war over the Nagorno-Karabakh enclave, horrific fighting in Ethiopia’s northern Tigray region that began weeks later, the conflict prompted by the Myanmar army’s 2021 power grab and Russia’s 2022 assault on Ukraine. Add to those 2023’s devastation in Sudan and Gaza. Around the globe, more people are dying in fighting, being forced from their homes or in need of life-saving aid than in decades.\n\nSource: [10 Conflicts to Watch in 2024](https://www.crisisgroup.org/global/10-conflicts-watch-2024)\n\nIn this article, we are going to be primarily focusing on the ongoing Myanmar Civil War which started in 2021. This civil war comes after Myanmar's long history of insurgencies post independence from British Rule. It had escalated significantly after the 2021 coup d'état on 1 February 2021 which saw the **Tatmadaw** (Myanmar's Military) overthrow the ruling party at the time.\n\n# Objective\n\nWe want to apply spatial point patterns analysis methods to discover the spatial and spatio-temporal distribution of armed conflict in Myanmar.\n\n# Packages\n\nWe will be using the following packages:\n\n-   sf\n-   tmap\n-   tidyverse\n-   sp\n-   raster\n-   spatstat\n-   sparr\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(sf, tmap, tidyverse, sp, raster, spatstat, sparr)\n```\n:::\n\n\n# Data\n\nTo achieve our objective, we will be using the following datasets\n\n-   Armed conflict data of Myanmar between 2021-2024 from [Armed Conflict Location & Event Data (ACLED)](https://acleddata.com/)\n\n-   [Geospatial data](http://geonode.themimu.info/layers/?limit=100&offset=0) on [Myanmar Information Management Unit, MIMU](http://www.themimu.info/)\n\n-   [OpenStreetMap](https://download.geofabrik.de/asia/myanmar.html) of Myanmar\n\n## Import\n\nWe first want to load in the conflict data ranging from 2021-2024\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconflict2124_sf <- read_csv(\"data/2021-01-01-2024-06-30-Myanmar.csv\") %>%\n  st_as_sf(coords = c(\"longitude\", \"latitude\"),\n           crs = 4326) %>%\n  st_transform(crs = 32647)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 51553 Columns: 31\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (20): event_id_cnty, event_date, disorder_type, event_type, sub_event_ty...\ndbl (11): year, time_precision, inter1, inter2, interaction, iso, latitude, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n\nWe also want to import our shapefile of administrative area 1\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmadm1_sf <- st_read(dsn = \"data/geospatial\", layer = \"mmr_polbnda2_adm1_250k_mimu_1\") %>%\n  st_transform(crs = 32647)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `mmr_polbnda2_adm1_250k_mimu_1' from data source \n  `/home/syoongy/Documents/code/SMU/is415/IS415-GAA/Take-home_EX/Take-home_Ex01/data/geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 18 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554\nGeodetic CRS:  WGS 84\n```\n\n\n:::\n:::\n\n\nFinally, we have the data from OpenStreetMap where we will focus on places\n\n::: {.cell}\n\n```{.r .cell-code}\nosm_sf <- st_read(\"data/geospatial/myanmar-latest-free.shp\",\n                      layer=\"gis_osm_places_a_free_1\") %>%\n  st_transform(crs = 32647)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `gis_osm_places_a_free_1' from data source \n  `/home/syoongy/Documents/code/SMU/is415/IS415-GAA/Take-home_EX/Take-home_Ex01/data/geospatial/myanmar-latest-free.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 10497 features and 5 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 92.24155 ymin: 9.606004 xmax: 101.0663 ymax: 28.17021\nGeodetic CRS:  WGS 84\n```\n\n\n:::\n:::\n\n\n## Wrangling\n\n### Conflict Data\nWe also want to add a column called `quarter` on our `conflict2124_sf` dataset to help when breaking down the data into yearly quarters. We will achieve this through the `quarter()` function from `lubridate`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconflict2124_sf <- conflict2124_sf %>% \n  mutate(event_date = dmy(event_date),quarter = quarter(event_date))\n```\n:::\n\n### Administrative Area 1\nWe first want to rename our states from `myanmaradm1` to have the same naming scheme as `conflict2124`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmadm1_sf$ST <- gsub(\"\\\\s*\\\\(([^)]+)\\\\)\", \"-\\\\1\", madm1_sf$ST)\n```\n:::\n\n### OpenStreetMap\nWith the OSM dataset being so large, we want to cut down on the dataset to only data that would be useful for our exploration. Let's first look at the different types of places available from our dataset by finding the unique values in the `fclass` column\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunique(osm_sf$fclass)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"island\"   \"town\"     \"village\"  \"city\"     \"suburb\"   \"hamlet\"  \n [7] \"locality\" \"farm\"     \"county\"   \"region\"  \n```\n\n\n:::\n:::\n\n\nWe can now cut out the place types that are irrelevant to us and also remove unnecessary columns\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplaces_to_keep <- c(\"village\", \"town\", \"city\")\n\n\nosm_sf <- osm_sf %>%\n  filter(fclass %in%  places_to_keep) %>%\n  dplyr::select(\"osm_id\", \"fclass\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(osm_sf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    osm_id             fclass                   geometry   \n Length:9513        Length:9513        MULTIPOLYGON :9513  \n Class :character   Class :character   epsg:32647   :   0  \n Mode  :character   Mode  :character   +proj=utm ...:   0  \n```\n\n\n:::\n:::\n\n\n### Joining Geospatial Data\n\nWe now want to combine both our geospatial datasets\n\n::: {.cell}\n\n```{.r .cell-code}\nmyanmar_merged <- st_intersection(osm_sf, madm1_sf)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(myanmar_merged)\n```\n:::\n\nLet's now save this data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_rds(myanmar_merged, \"data/rds/myanmar_merged.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmyanmar_merged_sf <- read_rds(\"data/rds/myanmar_merged.rds\") %>%\n  st_as_sf(coords = c(\"longitude\", \"latitude\"), crs = 32647)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(myanmar_merged_sf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    osm_id             fclass             OBJECTID           ST           \n Length:9517        Length:9517        Min.   : 1.000   Length:9517       \n Class :character   Class :character   1st Qu.: 8.000   Class :character  \n Mode  :character   Mode  :character   Median : 9.000   Mode  :character  \n                                       Mean   : 8.924                     \n                                       3rd Qu.:13.000                     \n                                       Max.   :18.000                     \n   ST_PCODE            ST_RG              ST_MMR             PCode_V   \n Length:9517        Length:9517        Length:9517        Min.   :9.4  \n Class :character   Class :character   Class :character   1st Qu.:9.4  \n Mode  :character   Mode  :character   Mode  :character   Median :9.4  \n                                                          Mean   :9.4  \n                                                          3rd Qu.:9.4  \n                                                          Max.   :9.4  \n          geometry   \n MULTIPOLYGON :   3  \n POLYGON      :9514  \n epsg:32647   :   0  \n +proj=utm ...:   0  \n                     \n                     \n```\n\n\n:::\n:::\n\n\nFinally, let's turn this into \n\n### Visualisation\n\nWe can first view the basemap of myanmar and its conflicts data combined through the use of `tmap` methods split year on year\n\n::: {.cell}\n\n```{.r .cell-code}\ntm_shape(madm1_sf) +\n  tm_polygons() +\n  tm_shape(conflict2124_sf) +\n  tm_dots() +\n  tm_facets(by=\"year\",\n              free.coords = FALSE,\n              drop.units = TRUE)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\nAt a glance, we can see intense conflicts in years 2021 and 2022 which slowly decreased over time in years 2023 and 2024. This lines up with the timeline in which the military overthrew the ruling government which would liekly lead to higher rates of conflict. As time went on, these conflicts would decrease as the military would be actively taking down any opposition forces. As we do not have the full year of 2024, we are unable to determine a further decrease.\n\n### PPP\nAs we will be looking at KDE data, we want to convert our conflict data into `PPP` objects\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconflict2124_ppp <- conflict2124_sf %>% {as.ppp(st_coordinates(.), st_bbox(.))}\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: data contain duplicated points\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(conflict2124_ppp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nPlanar point pattern:  51553 points\nAverage intensity 3.12815e-08 points per square unit\n\n*Pattern contains duplicated points*\n\nCoordinates are given to 13 decimal places\n\nWindow: rectangle = [-208804.4, 640934.5] x [1103500.1, 3042960.3] units\n                    (849700 x 1939000 units)\nWindow area = 1.64803e+12 square units\n```\n\n\n:::\n:::\n\n\nLet's first create an object to store all our split data called `conflict2124_ppp_list` and add in the years we want to look at\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconflict2124_ppp_list <- list(\n  \"2021\" = list(\n    \"Q1\" = list(),\n    \"Q2\" = list(),\n    \"Q3\" = list(),\n    \"Q4\" = list()\n  ),\n  \"2022\" = list(\n    \"Q1\" = list(),\n    \"Q2\" = list(),\n    \"Q3\" = list(),\n    \"Q4\" = list()\n  ),\n  \"2023\" = list(\n    \"Q1\" = list(),\n    \"Q2\" = list(),\n    \"Q3\" = list(),\n    \"Q4\" = list()\n  ),\n  \"2024\" = list(\n    \"Q1\" = list(),\n    \"Q2\" = list(),\n    \"Q3\" = list(),\n    \"Q4\" = list()\n  )\n)\n```\n:::\n\nWe now want to assign our filtered quarter data into each of the years\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfor (targetyear in 2021:2024) {\n  for (targetquarter in 1:4) {\n    quarter_name <- paste0(\"Q\", targetquarter)\n    filtered_data <- conflict2124_sf %>%\n      filter(year == as.character(targetyear) & quarter == as.character(targetquarter))\n    \n    if (nrow(filtered_data) > 0) {\n      conflict2124_ppp_list[[as.character(targetyear)]][[quarter_name]] <- as.ppp(st_coordinates(filtered_data), st_bbox(filtered_data))\n    }\n  }\n}\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\n```\n\n\n:::\n:::\n\n\n\n#### Deduplication\nAs we get a warning of duplicated points, we should aim to remove as many as possible. Let's first find out how many duplicated points we have through the use of `sum()` and `multiplicity()`.\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(multiplicity(conflict2124_ppp) > 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 48258\n```\n\n\n:::\n:::\n\n\nLet's now remove these points using `rjitter()` to shift our points slightly.\n\n::: {.cell}\n\n```{.r .cell-code}\nconflict2124_ppp <- rjitter(conflict2124_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n\nWe can now use `any()` and `duplicated()` to check if there are still duplicated points\n\n\n::: {.cell}\n\n```{.r .cell-code}\nany(duplicated(conflict2124_ppp))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] FALSE\n```\n\n\n:::\n:::\n\n\nWe want to repeat this with the values in our ppp_list too\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfor (targetyear in names(conflict2124_ppp_list)) {\n  for (targetquarter in names(conflict2124_ppp_list[[targetyear]])) {\n    ppp_obj <- conflict2124_ppp_list[[as.character(targetyear)]][[targetquarter]]\n    if (class(ppp_obj) == \"ppp\") {\n      # Apply rjitter() to the ppp_obj\n      jittered_ppp <- rjitter(ppp_obj, retry = TRUE, nsim = 1, drop = TRUE)\n      \n      # Assign the jittered ppp object back to the list\n      conflict2124_ppp_list[[as.character(targetyear)]][[targetquarter]] <- jittered_ppp\n      print(any(duplicated(conflict2124_ppp_list[[as.character(targetyear)]][[targetquarter]])))\n    }\n  }\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] FALSE\n[1] FALSE\n[1] FALSE\n[1] FALSE\n[1] FALSE\n[1] FALSE\n[1] FALSE\n[1] FALSE\n[1] FALSE\n[1] FALSE\n[1] FALSE\n[1] FALSE\n[1] FALSE\n[1] FALSE\n```\n\n\n:::\n:::\n\n\n### Owin\nWe also want to create an `owin` object to ensure that all points we are looking at are within the Myanmar boundary.\n\n::: {.cell}\n\n```{.r .cell-code}\nmadm1_owin <- as.owin(madm1_sf)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(madm1_owin)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n\nNow let's combine this with our conflict data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconflict2124_ppp_list <- lapply(conflict2124_ppp_list, function(year_data_list) {\n  lapply(year_data_list, function(quarter_data) {\n    if (class(quarter_data) == \"ppp\")\n      quarter_data[madm1_owin]\n  })\n})\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(conflict2124_ppp_list$\"2024\"$Q1)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(conflict2124_ppp_list$\"2024\"$Q2)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\n# Quarterly KDE\nNow let's view the quarterly KDE for our data. However, we first need to rescale our data to use KM.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconflict2124_ppp_list.km <- lapply(conflict2124_ppp_list, function(year_data_list) {\n  lapply(year_data_list, function(quarter_data) {\n    if (class(quarter_data) == \"ppp\")\n      rescale.ppp(quarter_data, 1000, \"km\")\n  })\n})\n```\n:::\n\nWe now want to find the ideal bandwith to use for our data\n\n## Automatic Bandwith\nLet's first compare using the bandwith functions of `diggle`, `CvL`, `ppl`, `scott`, \n\n::: panel-tabset\n### bw.diggle\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconflict.bw <- density(conflict2124_ppp_list.km$\"2021\"$Q1,\n             sigma=bw.diggle, \n             edge=TRUE, \n             kernel=\"gaussian\")\nplot(conflict.bw)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n:::\n\n### bw.CvL\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconflict.bw <- density(conflict2124_ppp_list.km$\"2021\"$Q1,\n             sigma=bw.CvL, \n             edge=TRUE, \n             kernel=\"gaussian\")\nplot(conflict.bw)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n:::\n\n\n### bw.ppl\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconflict.bw <- density(conflict2124_ppp_list.km$\"2021\"$Q1,\n             sigma=bw.ppl, \n             edge=TRUE, \n             kernel=\"gaussian\")\nplot(conflict.bw)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n:::\n\n\n### bw.scott\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconflict.bw <- density(conflict2124_ppp_list.km$\"2021\"$Q1,\n             sigma=bw.scott, \n             edge=TRUE, \n             kernel=\"gaussian\")\nplot(conflict.bw)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-33-1.png){width=672}\n:::\n:::\n\n:::\n\n## Manual Bandwith\nWe can also look at how our KDE will look with some manual values\n\n::: panel-tabset\n### Signma 10\n\n::: {.cell}\n\n```{.r .cell-code}\nconflict.bw <- density(conflict2124_ppp_list.km$\"2021\"$Q1,\n             sigma=10, \n             edge=TRUE, \n             kernel=\"gaussian\")\nplot(conflict.bw)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-34-1.png){width=672}\n:::\n:::\n\n### Signma 20\n\n::: {.cell}\n\n```{.r .cell-code}\nconflict.bw <- density(conflict2124_ppp_list.km$\"2021\"$Q1,\n             sigma=20, \n             edge=TRUE, \n             kernel=\"gaussian\")\nplot(conflict.bw)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-35-1.png){width=672}\n:::\n:::\n\n### Signma 30\n\n::: {.cell}\n\n```{.r .cell-code}\nconflict.bw <- density(conflict2124_ppp_list.km$\"2021\"$Q1,\n             sigma=30, \n             edge=TRUE, \n             kernel=\"gaussian\")\nplot(conflict.bw)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-36-1.png){width=672}\n:::\n:::\n\n:::\n\nWhen looking at the results, `scott` looks to give the best results. So for the next portions we will be using that.\n\n::: panel-tabset\n### 2021\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow=c(2,2))\nplot(density(conflict2124_ppp_list.km$\"2021\"$Q1, \n             sigma=bw.scott, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main=\"2021 Q1\")\nplot(density(conflict2124_ppp_list.km$\"2021\"$Q2, \n             sigma=bw.scott, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main=\"2021 Q2\")\nplot(density(conflict2124_ppp_list.km$\"2021\"$Q3, \n             sigma=bw.scott, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main=\"2021 Q3\")\nplot(density(conflict2124_ppp_list.km$\"2021\"$Q4, \n             sigma=bw.scott, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main=\"2021 Q4\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-37-1.png){width=1920}\n:::\n:::\n\n\n\n### 2022\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow=c(2,2))\nplot(density(conflict2124_ppp_list.km$\"2022\"$Q1, \n             sigma=bw.scott, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main=\"2022 Q1\")\nplot(density(conflict2124_ppp_list.km$\"2022\"$Q2, \n             sigma=bw.scott, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main=\"2022 Q2\")\nplot(density(conflict2124_ppp_list.km$\"2022\"$Q3, \n             sigma=bw.scott, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main=\"2022 Q3\")\nplot(density(conflict2124_ppp_list.km$\"2022\"$Q4, \n             sigma=bw.scott, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main=\"2022 Q4\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-38-1.png){width=1920}\n:::\n:::\n\n\n\n### 2023\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow=c(2,2))\nplot(density(conflict2124_ppp_list.km$\"2023\"$Q1, \n             sigma=bw.scott, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main=\"2023 Q1\")\nplot(density(conflict2124_ppp_list.km$\"2023\"$Q2, \n             sigma=bw.scott, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main=\"2023 Q2\")\nplot(density(conflict2124_ppp_list.km$\"2023\"$Q3, \n             sigma=bw.scott, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main=\"2023 Q3\")\nplot(density(conflict2124_ppp_list.km$\"2023\"$Q4, \n             sigma=bw.scott, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main=\"2023 Q4\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-39-1.png){width=1920}\n:::\n:::\n\n\n\n### 2024\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow=c(1,2))\nplot(density(conflict2124_ppp_list.km$\"2024\"$Q1, \n             sigma=bw.scott, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main=\"2024 Q1\")\nplot(density(conflict2124_ppp_list.km$\"2024\"$Q2, \n             sigma=bw.scott, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main=\"2024 Q2\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-40-1.png){width=1920}\n:::\n:::\n\n:::\n\n# Second-order Spatial Point Patterns Analysis\n## Scope\nI would like to scope down to the Sagaing Region as it has been a hotspot for clashes between the military and armed resistance groups.\n\nWe first need to retrieve our Sagaing data as an `sf` object\n\n::: {.cell}\n\n```{.r .cell-code}\nsagaing_sf <- madm1_sf %>%\n  filter(ST == \"Sagaing\")\n```\n:::\n\n\nWe can now create an owin object using this\n\n::: {.cell}\n\n```{.r .cell-code}\nsagaing_owin <- as.owin(sagaing_sf)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(sagaing_owin)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-43-1.png){width=672}\n:::\n:::\n\n\n## PPP\nWe want to now retrieve PPP objects for the different types of conflicts based on each year. This will help us see the change over time regarding the different types of conflicts.\n\nLet's first create a list to store this data. This will contain 4 different categories of battles, explosion/remote violence, strategic developments, violence against civilians.\n\n::: {.cell}\n\n```{.r .cell-code}\nconflict_sagaing_ppp_list <- list(\n  \"2021\" = list(\n    \"Battles\" = list(),\n    \"Explosions/Remote violence\" = list(),\n    \"Strategic developments\" = list(),\n    \"Violence against civilians\" = list()\n  ),\n  \"2022\" = list(\n    \"Battles\" = list(),\n    \"Explosions/Remote violence\" = list(),\n    \"Strategic developments\" = list(),\n    \"Violence against civilians\" = list()\n  ),\n  \"2023\" = list(\n    \"Battles\" = list(),\n    \"Explosions/Remote violence\" = list(),\n    \"Strategic developments\" = list(),\n    \"Violence against civilians\" = list()\n  ),\n  \"2024\" = list(\n    \"Battles\" = list(),\n    \"Explosions/Remote violence\" = list(),\n    \"Strategic developments\" = list(),\n    \"Violence against civilians\" = list()\n  )\n)\n```\n:::\n\n\nLet's now assign the data\n\n::: {.cell}\n\n```{.r .cell-code}\nfor (targetyear in 2021:2024) {\n  for (targetevent in names(conflict_sagaing_ppp_list[[as.character(targetyear)]])) {\n    filtered_data <- conflict2124_sf %>%\n      filter(year == as.character(targetyear) & event_type == targetevent)\n    \n    if (nrow(filtered_data) > 0) {\n      conflict_sagaing_ppp_list[[as.character(targetyear)]][[targetevent]] <- as.ppp(st_coordinates(filtered_data), st_bbox(filtered_data))\n    }\n  }\n}\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\nWarning: data contain duplicated points\n```\n\n\n:::\n:::\n\n### Deduplication\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfor (targetyear in names(conflict_sagaing_ppp_list)) {\n  for (targetevent in names(conflict_sagaing_ppp_list[[targetyear]])) {\n    ppp_obj <- conflict_sagaing_ppp_list[[as.character(targetyear)]][[targetevent]]\n    if (class(ppp_obj) == \"ppp\") {\n      # Apply rjitter() to the ppp_obj\n      jittered_ppp <- rjitter(ppp_obj, retry = TRUE, nsim = 1, drop = TRUE)\n      \n      # Assign the jittered ppp object back to the list\n      conflict_sagaing_ppp_list[[as.character(targetyear)]][[targetevent]] <- jittered_ppp\n      print(any(duplicated(conflict_sagaing_ppp_list[[as.character(targetyear)]][[targetevent]])))\n    }\n  }\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] FALSE\n[1] FALSE\n[1] FALSE\n[1] FALSE\n[1] FALSE\n[1] FALSE\n[1] FALSE\n[1] FALSE\n[1] FALSE\n[1] FALSE\n[1] FALSE\n[1] FALSE\n[1] FALSE\n[1] FALSE\n[1] FALSE\n[1] FALSE\n```\n\n\n:::\n:::\n\n\n## Sagaing Conflict Data\nNow that we have removed the duplicates, we can now scope down our data further to only look at the armed conflict in Sagaing\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconflict_sagaing_ppp_list <- lapply(conflict_sagaing_ppp_list, function(year_data_list) {\n  lapply(year_data_list, function(event_data) {\n    if (class(event_data) == \"ppp\")\n      event_data[sagaing_owin]\n  })\n})\n```\n:::\n\n\n## G-Function\nThe **G function** measures the distribution of the distances from an arbitrary even to its nearest event.\n\n### Battles\n\n::: panel-tabset\n\n#### 2021\n\n\n::: {.cell}\n\n```{.r .cell-code}\nG_battles_2021 <- Gest(conflict_sagaing_ppp_list$\"2021\"$Battles, correction = \"border\")\nplot(G_battles_2021, xlim=c(0,500))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-48-1.png){width=672}\n:::\n:::\n\n\n#### 2022\n\n\n::: {.cell}\n\n```{.r .cell-code}\nG_battles_2022 <- Gest(conflict_sagaing_ppp_list$\"2022\"$Battles, correction = \"border\")\nplot(G_battles_2022, xlim=c(0,500))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-49-1.png){width=672}\n:::\n:::\n\n\n#### 2023\n\n\n::: {.cell}\n\n```{.r .cell-code}\nG_battles_2023 <- Gest(conflict_sagaing_ppp_list$\"2023\"$Battles, correction = \"border\")\nplot(G_battles_2023, xlim=c(0,500))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-50-1.png){width=672}\n:::\n:::\n\n\n#### 2024\n\n\n::: {.cell}\n\n```{.r .cell-code}\nG_battles_2024 <- Gest(conflict_sagaing_ppp_list$\"2024\"$Battles, correction = \"border\")\nplot(G_battles_2024, xlim=c(0,500))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-51-1.png){width=672}\n:::\n:::\n\n:::\n\n### Explosion/Remote Violence\n::: panel-tabset\n#### 2021\n\n\n::: {.cell}\n\n```{.r .cell-code}\nG_explosives_2021 <- Gest(conflict_sagaing_ppp_list$\"2021\"$`Explosions/Remote violence`, correction = \"border\")\nplot(G_explosives_2021, xlim=c(0,500))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-52-1.png){width=672}\n:::\n:::\n\n\n#### 2022\n\n\n::: {.cell}\n\n```{.r .cell-code}\nG_explosives_2022 <- Gest(conflict_sagaing_ppp_list$\"2022\"$`Explosions/Remote violence`, correction = \"border\")\nplot(G_explosives_2022, xlim=c(0,500))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-53-1.png){width=672}\n:::\n:::\n\n\n#### 2023\n\n\n::: {.cell}\n\n```{.r .cell-code}\nG_explosives_2023 <- Gest(conflict_sagaing_ppp_list$\"2023\"$`Explosions/Remote violence`, correction = \"border\")\nplot(G_explosives_2023, xlim=c(0,500))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-54-1.png){width=672}\n:::\n:::\n\n\n#### 2024\n\n\n::: {.cell}\n\n```{.r .cell-code}\nG_explosives_2024 <- Gest(conflict_sagaing_ppp_list$\"2024\"$`Explosions/Remote violence`, correction = \"border\")\nplot(G_explosives_2024, xlim=c(0,500))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-55-1.png){width=672}\n:::\n:::\n\n:::\n\n### Strategic Developments\n::: panel-tabset\n#### 2021\n\n\n::: {.cell}\n\n```{.r .cell-code}\nG_sd_2021 <- Gest(conflict_sagaing_ppp_list$\"2021\"$`Strategic developments`, correction = \"border\")\nplot(G_sd_2021, xlim=c(0,500))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-56-1.png){width=672}\n:::\n:::\n\n\n#### 2022\n\n\n::: {.cell}\n\n```{.r .cell-code}\nG_sd_2022 <- Gest(conflict_sagaing_ppp_list$\"2022\"$`Strategic developments`, correction = \"border\")\nplot(G_sd_2022, xlim=c(0,500))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-57-1.png){width=672}\n:::\n:::\n\n\n#### 2023\n\n\n::: {.cell}\n\n```{.r .cell-code}\nG_sd_2023 <- Gest(conflict_sagaing_ppp_list$\"2023\"$`Strategic developments`, correction = \"border\")\nplot(G_sd_2023, xlim=c(0,500))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-58-1.png){width=672}\n:::\n:::\n\n\n#### 2024\n\n\n::: {.cell}\n\n```{.r .cell-code}\nG_sd_2024 <- Gest(conflict_sagaing_ppp_list$\"2024\"$`Strategic developments`, correction = \"border\")\nplot(G_sd_2024, xlim=c(0,500))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-59-1.png){width=672}\n:::\n:::\n\n:::\n\n### Violence against civilians\n::: panel-tabset\n#### 2021\n\n\n::: {.cell}\n\n```{.r .cell-code}\nG_VaC_2021 <- Gest(conflict_sagaing_ppp_list$\"2021\"$`Violence against civilians`, correction = \"border\")\nplot(G_VaC_2021, xlim=c(0,500))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-60-1.png){width=672}\n:::\n:::\n\n\n#### 2022\n\n\n::: {.cell}\n\n```{.r .cell-code}\nG_VaC_2022 <- Gest(conflict_sagaing_ppp_list$\"2022\"$`Violence against civilians`, correction = \"border\")\nplot(G_VaC_2022, xlim=c(0,500))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-61-1.png){width=672}\n:::\n:::\n\n\n#### 2023\n\n\n::: {.cell}\n\n```{.r .cell-code}\nG_VaC_2023 <- Gest(conflict_sagaing_ppp_list$\"2023\"$`Violence against civilians`, correction = \"border\")\nplot(G_VaC_2023, xlim=c(0,500))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-62-1.png){width=672}\n:::\n:::\n\n\n#### 2024\n\n\n::: {.cell}\n\n```{.r .cell-code}\nG_VaC_2024 <- Gest(conflict_sagaing_ppp_list$\"2024\"$`Violence against civilians`, correction = \"border\")\nplot(G_VaC_2024, xlim=c(0,500))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-63-1.png){width=672}\n:::\n:::\n\n:::\n\n## Complete Spatial Randomness Test\n\nTo see if the the different event types are cluster or randomly dispersed. The hypothesis and test are as follows:\n\nHo = The distribution of a certain event at Sagaing region are randomly distributed.\n\nH1 = The distribution of a certain event at Sagaing region are not randomly distributed.\n\nThe null hypothesis will be rejected if p-value is smaller than alpha value of 0.001.\n\n### Battles\n\n::: panel-tabset\n#### 2021\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(448)\nG_battles_2021.csr <- envelope(conflict_sagaing_ppp_list$\"2021\"$Battles, Gest, nsim = 99)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(G_battles_2021.csr)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-64-1.png){width=672}\n:::\n:::\n\n\n### 2022\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(448)\nG_battles_2022.csr <- envelope(conflict_sagaing_ppp_list$\"2022\"$Battles, Gest, nsim = 99)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(G_battles_2022.csr)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-65-1.png){width=672}\n:::\n:::\n\n\n### 2023\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(448)\nG_battles_2023.csr <- envelope(conflict_sagaing_ppp_list$\"2023\"$Battles, Gest, nsim = 99)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(G_battles_2023.csr)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-66-1.png){width=672}\n:::\n:::\n\n\n### 2024\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(448)\nG_battles_2024.csr <- envelope(conflict_sagaing_ppp_list$\"2024\"$Battles, Gest, nsim = 99)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(G_battles_2024.csr)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-67-1.png){width=672}\n:::\n:::\n\n:::\n\nWith all the results across the years being above the envelope, we can conclude that conflicts relating to battle are highly clustered within the Sagaing region\n\n### Explosion/Remote violence\n\n::: panel-tabset\n#### 2021\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(448)\nG_explosives_2021.csr <- envelope(conflict_sagaing_ppp_list$\"2021\"$`Explosions/Remote violence`, Gest, nsim = 99)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(G_explosives_2021.csr)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-68-1.png){width=672}\n:::\n:::\n\n\n#### 2022\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(448)\nG_explosives_2022.csr <- envelope(conflict_sagaing_ppp_list$\"2022\"$`Explosions/Remote violence`, Gest, nsim = 99)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(G_explosives_2022.csr)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-69-1.png){width=672}\n:::\n:::\n\n\n#### 2023\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(448)\nG_explosives_2023.csr <- envelope(conflict_sagaing_ppp_list$\"2023\"$`Explosions/Remote violence`, Gest, nsim = 99)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(G_explosives_2023.csr)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-70-1.png){width=672}\n:::\n:::\n\n\n#### 2024\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(448)\nG_explosives_2024.csr <- envelope(conflict_sagaing_ppp_list$\"2024\"$`Explosions/Remote violence`, Gest, nsim = 99)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(G_explosives_2024.csr)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-71-1.png){width=672}\n:::\n:::\n\n:::\n\nWe see a smilar story with explosives where across the years all values are above the envelope which means these events are clustered.\n\n### Strategic Developments\n\n::: panel-tabset\n#### 2021\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(448)\nG_sd_2021.csr <- envelope(conflict_sagaing_ppp_list$\"2021\"$`Strategic developments`, Gest, nsim = 99)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(G_sd_2021.csr)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-72-1.png){width=672}\n:::\n:::\n\n\n#### 2022\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(448)\nG_sd_2022.csr <- envelope(conflict_sagaing_ppp_list$\"2022\"$`Strategic developments`, Gest, nsim = 99)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(G_sd_2022.csr)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-73-1.png){width=672}\n:::\n:::\n\n\n#### 2023\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(448)\nG_sd_2023.csr <- envelope(conflict_sagaing_ppp_list$\"2023\"$`Strategic developments`, Gest, nsim = 99)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(G_sd_2023.csr)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-74-1.png){width=672}\n:::\n:::\n\n\n#### 2024\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(448)\nG_sd_2024.csr <- envelope(conflict_sagaing_ppp_list$\"2024\"$`Strategic developments`, Gest, nsim = 99)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(G_sd_2024.csr)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-75-1.png){width=672}\n:::\n:::\n\n:::\n\nAgain, we see a similar trend with strategic developments where they are clustered across all years.\n### Violence against civilians\n\n::: panel-tabset\n#### 2021\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(448)\nG_VaC_2021.csr <- envelope(conflict_sagaing_ppp_list$\"2021\"$`Violence against civilians`, Gest, nsim = 99)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(G_VaC_2021.csr)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-76-1.png){width=672}\n:::\n:::\n\n\n#### 2022\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(448)\nG_VaC_2022.csr <- envelope(conflict_sagaing_ppp_list$\"2022\"$`Violence against civilians`, Gest, nsim = 99)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(G_VaC_2022.csr)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-77-1.png){width=672}\n:::\n:::\n\n\n#### 2023\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(448)\nG_VaC_2023.csr <- envelope(conflict_sagaing_ppp_list$\"2023\"$`Violence against civilians`, Gest, nsim = 99)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(G_VaC_2023.csr)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-78-1.png){width=672}\n:::\n:::\n\n\n#### 2024\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(448)\nG_VaC_2024.csr <- envelope(conflict_sagaing_ppp_list$\"2024\"$`Violence against civilians`, Gest, nsim = 99)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(G_VaC_2024.csr)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-79-1.png){width=672}\n:::\n:::\n\n:::\n\nBy this point, it is safe to conclude that all events within this region are highly clustered. This likely indicates that the region itself is a hotspot for these events\n## KDE on OpenStreetMap\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntest_density <- density(conflict_sagaing_ppp_list$\"2022\"$Battles, \n             sigma=bw.scott, \n             edge=TRUE, \n             kernel=\"gaussian\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndensity_raster <- raster(test_density)\nprojection(density_raster) <- CRS(\"+init=EPSG:32647\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntm_shape(density_raster) +\n  tm_raster() +\n  tm_shape(myanmar_merged_sf %>% filter(ST == \"Sagaing\")) +\n  tm_dots()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nVariable(s) \"NA\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLegend labels were too wide. The labels have been resized to 0.33, 0.33, 0.33, 0.33. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-82-1.png){width=672}\n:::\n:::\n\n\n## Insights\nIn the Sagaing region, conflicts are commonplace with all types of conflicts ranging from violence to explosives being constant and clustered throughout the years. We can see most of the conflicts near the bottom of Sagaing and are towards the center of Myanmar which is also where a lot of conflicts within our data are clustered.\n\n# STKDE\nFor this, we will need to retrieve only the `quarter` column from each year\n\nWe first create a list\n\n::: {.cell}\n\n```{.r .cell-code}\nstkde_list_ppp = list(\n  \"2021\" = NULL,\n  \"2022\" = NULL,\n  \"2023\" = NULL,\n  \"2024\" = NULL\n)\n```\n:::\n\n\nAnd now we fill the data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfor (targetyear in 2021:2024) {\n    filtered_data <- conflict2124_sf %>%\n      filter(year == as.character(targetyear)) %>%\n      dplyr::select(quarter)\n    stkde_list_ppp[[as.character(targetyear)]] <-  as.ppp(filtered_data)\n}\n```\n:::\n\n\n## Deduplication\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstkde_list_ppp <- lapply(stkde_list_ppp, function(year_data) {\n  rjitter(year_data, \n           retry=TRUE, \n           nsim=1, \n           drop=TRUE)\n})\n```\n:::\n\n## Combined Data\n\nNow let's combine our data with the `madm1_owin` object\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstkde_list_ppp <- lapply(stkde_list_ppp, function(year_data) {\n  year_data[madm1_owin]\n})\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfor(targetyear in names(stkde_list_ppp)) {\n  plot(stkde_list_ppp[[as.character(targetyear)]], main = as.character(targetyear))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-87-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-87-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-87-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-87-4.png){width=672}\n:::\n:::\n\n\n## Plotting\nNow we can finally plot the STKDE using `spattemp.density()`\n\n::: panel-tabset\n### 2021\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconflict_kde_2021 <- spattemp.density(stkde_list_ppp$\"2021\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(conflict_kde_2021)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSpatiotemporal Kernel Density Estimate\n\nBandwidths\n  h = 50178.08 (spatial)\n  lambda = 0.0013 (temporal)\n\nNo. of observations\n  16180 \n\nSpatial bound\n  Type: polygonal\n  2D enclosure: [-210008.6, 724647.6] x [1072026, 3158467]\n\nTemporal bound\n  [1, 4]\n\nEvaluation\n  128 x 128 x 4 trivariate lattice\n  Density range: [7.381323e-14, 2.161734e-09]\n```\n\n\n:::\n:::\n\n\n### 2022\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconflict_kde_2022 <- spattemp.density(stkde_list_ppp$\"2022\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(conflict_kde_2022)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSpatiotemporal Kernel Density Estimate\n\nBandwidths\n  h = 45214.96 (spatial)\n  lambda = 0.0014 (temporal)\n\nNo. of observations\n  15897 \n\nSpatial bound\n  Type: polygonal\n  2D enclosure: [-210008.6, 724647.6] x [1072026, 3158467]\n\nTemporal bound\n  [1, 4]\n\nEvaluation\n  128 x 128 x 4 trivariate lattice\n  Density range: [7.950001e-18, 2.238789e-09]\n```\n\n\n:::\n:::\n\n\n### 2023\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconflict_kde_2023 <- spattemp.density(stkde_list_ppp$\"2023\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(conflict_kde_2023)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSpatiotemporal Kernel Density Estimate\n\nBandwidths\n  h = 53219.16 (spatial)\n  lambda = 0.0017 (temporal)\n\nNo. of observations\n  13184 \n\nSpatial bound\n  Type: polygonal\n  2D enclosure: [-210008.6, 724647.6] x [1072026, 3158467]\n\nTemporal bound\n  [1, 4]\n\nEvaluation\n  128 x 128 x 4 trivariate lattice\n  Density range: [4.964293e-20, 1.527497e-09]\n```\n\n\n:::\n:::\n\n\n### 2024\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconflict_kde_2024 <- spattemp.density(stkde_list_ppp$\"2024\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCalculating trivariate smooth...Done.\nEdge-correcting...Done.\nConditioning on time...Done.\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(conflict_kde_2024)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSpatiotemporal Kernel Density Estimate\n\nBandwidths\n  h = 64197.39 (spatial)\n  lambda = 8e-04 (temporal)\n\nNo. of observations\n  5985 \n\nSpatial bound\n  Type: polygonal\n  2D enclosure: [-210008.6, 724647.6] x [1072026, 3158467]\n\nTemporal bound\n  [1, 2]\n\nEvaluation\n  128 x 128 x 2 trivariate lattice\n  Density range: [1.004413e-12, 4.489329e-09]\n```\n\n\n:::\n:::\n\n:::\n\nLet's finally plot the STKDE graphs\n\n::: panel-tabset\n### 2021\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntims <- c(1,2,3,4)\n\npar(mfrow=c(1,4), cex.main = 1.5)\nfor(i in tims){\n  plot(conflict_kde_2021, i, \n       fix.range=TRUE,\n       override.par=FALSE,\n       main=paste(\"STKDE Q\",i))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-92-1.png){width=672}\n:::\n:::\n\n\n### 2022\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow=c(1,4), cex.main = 1.5)\nfor(i in tims){\n  plot(conflict_kde_2022, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"STKDE Q\",i))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-93-1.png){width=672}\n:::\n:::\n\n\n### 2023\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow=c(1,4),cex.main = 1.5)\n\nfor(i in tims){\n  plot(conflict_kde_2023, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"STKDE Q\",i))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-94-1.png){width=672}\n:::\n:::\n\n\n### 2024\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntims_2 <- c(1,2)\n\npar(mfrow=c(1,2), cex.main = 1.2)\nfor(i in tims_2){\n  plot(conflict_kde_2024, i, \n       override.par=FALSE, \n       fix.range=TRUE,\n       main=paste(\"STKDE Q\",i))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-95-1.png){width=672}\n:::\n:::\n\n:::\n\n## 2nd Order STKDE\n\nFor this, we will be focusing again on the conflicts in the Sagaing region in 2024\n\n::: {.cell}\n\n```{.r .cell-code}\nconflict_sagaing_2024_ppp_list <- list(\n    \"Battles\" = NULL,\n    \"Explosions/Remote violence\" = NULL,\n    \"Strategic developments\" = NULL,\n    \"Violence against civilians\" = NULL\n  \n)\n```\n:::\n\n\n\nLet's now assign the data\n\n::: {.cell}\n\n```{.r .cell-code}\nfor (targetevent in names(conflict_sagaing_2024_ppp_list)) {\n  filtered_data <- conflict2124_sf %>%\n    filter(year == \"2024\" & event_type == targetevent)\n  \n  if (nrow(filtered_data) > 0) {\n    conflict_sagaing_2024_ppp_list[[targetevent]] <- as.ppp(filtered_data)\n  }\n}\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in as.ppp.sf(filtered_data): only first attribute column is used for\nmarks\nWarning in as.ppp.sf(filtered_data): only first attribute column is used for\nmarks\nWarning in as.ppp.sf(filtered_data): only first attribute column is used for\nmarks\nWarning in as.ppp.sf(filtered_data): only first attribute column is used for\nmarks\n```\n\n\n:::\n:::\n\n\nWe once again deduplicate\n\n::: {.cell}\n\n```{.r .cell-code}\nconflict_sagaing_2024_ppp_list <- lapply(conflict_sagaing_2024_ppp_list, function(event) {\n  rjitter(event, \n           retry=TRUE, \n           nsim=1, \n           drop=TRUE)\n})\n```\n:::\n\n\nAnd scope it down to Sagaing\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconflict_sagaing_2024_ppp_list <- lapply(conflict_sagaing_2024_ppp_list, function(event) {\n  event[sagaing_owin]\n})\n```\n:::\n\n::: panel-tabset\n### Battle\n\n\n::: {.cell}\n\n```{.r .cell-code}\nK_battle = Kest(conflict_sagaing_2024_ppp_list$Battles, correction = \"Ripley\")\nplot(K_battle, . -r ~ r, ylab= \"K(d)-r\", xlab = \"d(m)\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-100-1.png){width=672}\n:::\n:::\n\n\n### Explosion/Remote violence\n\n\n::: {.cell}\n\n```{.r .cell-code}\nK_explosion = Kest(conflict_sagaing_2024_ppp_list$`Explosions/Remote violence`, correction = \"Ripley\")\nplot(K_explosion, . -r ~ r, ylab= \"K(d)-r\", xlab = \"d(m)\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-101-1.png){width=672}\n:::\n:::\n\n\n### Strategic Development\n\n\n::: {.cell}\n\n```{.r .cell-code}\nK_Strat = Kest(conflict_sagaing_2024_ppp_list$`Strategic developments`, correction = \"Ripley\")\nplot(K_Strat, . -r ~ r, ylab= \"K(d)-r\", xlab = \"d(m)\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-102-1.png){width=672}\n:::\n:::\n\n\n### Violence against civilians\n\n\n::: {.cell}\n\n```{.r .cell-code}\nK_violence = Kest(conflict_sagaing_2024_ppp_list$`Violence against civilians`, correction = \"Ripley\")\nplot(K_violence, . -r ~ r, ylab= \"K(d)-r\", xlab = \"d(m)\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-103-1.png){width=672}\n:::\n:::\n\n:::\n\nFinally let's run the CSR simulation and plot it. If its\n\n-   Above the envelop: significant cluster pattern\n\n-   Below the envelop: significant regular\n\n-   Inside the envelop: CSR\n\n::: panel-tabset\n### Battles\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(448)\nK_battle.csr <- envelope(conflict_sagaing_2024_ppp_list$Battles, Kest, nsim = 99, rank = 1, glocal=TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 99 simulations of CSR  ...\n1, 2,  [4:56 remaining] 3,\n [4:13 remaining] 4,  [4:06 remaining] 5,  [4:03 remaining] 6,\n [3:58 remaining] 7,  [3:56 remaining] 8,  [3:57 remaining] 9,\n [3:50 remaining] 10,  [3:46 remaining] 11,  [3:42 remaining] 12,\n [3:43 remaining] 13,  [3:37 remaining] 14,  [3:35 remaining] 15,\n [3:31 remaining] 16,  [3:27 remaining] 17,  [3:25 remaining] 18,\n [3:24 remaining] 19,  [3:21 remaining] 20,  [3:19 remaining] 21,\n [3:16 remaining] 22,  [3:13 remaining] 23,  [3:11 remaining] 24,\n [3:08 remaining] 25,  [3:06 remaining] 26,  [3:04 remaining] 27,\n [3:01 remaining] 28,  [2:59 remaining] 29,  [2:56 remaining] 30,\n [2:54 remaining] 31,  [2:53 remaining] 32,  [2:53 remaining] 33,\n [2:52 remaining] 34,  [2:49 remaining] 35,  [2:47 remaining] 36,\n [2:44 remaining] 37,  [2:42 remaining] 38,  [2:39 remaining] 39,\n [2:36 remaining] 40,  [2:33 remaining] 41,  [2:31 remaining] 42,\n [2:28 remaining] 43,  [2:26 remaining] 44,  [2:23 remaining] 45,\n [2:20 remaining] 46,  [2:17 remaining] 47,  [2:14 remaining] 48,\n [2:12 remaining] 49,  [2:09 remaining] 50,  [2:06 remaining] 51,\n [2:04 remaining] 52,  [2:01 remaining] 53,  [1:59 remaining] 54,\n [1:57 remaining] 55,  [1:55 remaining] 56,  [1:52 remaining] 57,\n [1:49 remaining] 58,  [1:47 remaining] 59,  [1:44 remaining] 60,\n [1:42 remaining] 61,  [1:39 remaining] 62,  [1:37 remaining] 63,\n [1:34 remaining] 64,  [1:31 remaining] 65,  [1:29 remaining] 66,\n [1:26 remaining] 67,  [1:24 remaining] 68,  [1:21 remaining] 69,\n [1:18 remaining] 70,  [1:15 remaining] 71,  [1:13 remaining] 72,\n [1:10 remaining] 73,  [1:08 remaining] 74,  [1:05 remaining] 75,\n [1:02 remaining] 76,  [1:00 remaining] 77,  [57 sec remaining] 78,\n [55 sec remaining] 79,  [52 sec remaining] 80,  [50 sec remaining] 81,\n [47 sec remaining] 82,  [44 sec remaining] 83,  [42 sec remaining] 84,\n [39 sec remaining] 85,  [36 sec remaining] 86,  [34 sec remaining] 87,\n [31 sec remaining] 88,  [29 sec remaining] 89,  [26 sec remaining] 90,\n [23 sec remaining] 91,  [21 sec remaining] 92,  [18 sec remaining] 93,\n [16 sec remaining] 94,  [13 sec remaining] 95,  [10 sec remaining] 96,\n [8 sec remaining] 97,  [5 sec remaining] 98,  [3 sec remaining] \n99.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(K_battle.csr, . - r ~ r, xlab=\"d\", ylab=\"K(d)-r\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-104-1.png){width=672}\n:::\n:::\n\n\n### Explosion/Remote violence\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(448)\nK_explosion.csr <- envelope(conflict_sagaing_2024_ppp_list$`Explosions/Remote violence`, Kest, nsim = 99, rank = 1, glocal=TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 99 simulations of CSR  ...\n1, 2,  [3:41 remaining] 3,\n [3:11 remaining] 4,  [3:10 remaining] 5,  [3:08 remaining] 6,\n [3:09 remaining] 7,  [3:04 remaining] 8,  [2:59 remaining] 9,\n [2:58 remaining] 10,  [2:56 remaining] 11,  [2:53 remaining] 12,\n [2:51 remaining] 13,  [2:50 remaining] 14,  [2:46 remaining] 15,\n [2:43 remaining] 16,  [2:43 remaining] 17,  [2:39 remaining] 18,\n [2:39 remaining] 19,  [2:37 remaining] 20,  [2:36 remaining] 21,\n [2:33 remaining] 22,  [2:33 remaining] 23,  [2:31 remaining] 24,\n [2:29 remaining] 25,  [2:27 remaining] 26,  [2:26 remaining] 27,\n [2:23 remaining] 28,  [2:22 remaining] 29,  [2:20 remaining] 30,\n [2:18 remaining] 31,  [2:16 remaining] 32,  [2:14 remaining] 33,\n [2:11 remaining] 34,  [2:09 remaining] 35,  [2:07 remaining] 36,\n [2:05 remaining] 37,  [2:03 remaining] 38,  [2:01 remaining] 39,\n [1:59 remaining] 40,  [1:58 remaining] 41,  [1:56 remaining] 42,\n [1:55 remaining] 43,  [1:53 remaining] 44,  [1:51 remaining] 45,\n [1:49 remaining] 46,  [1:47 remaining] 47,  [1:45 remaining] 48,\n [1:43 remaining] 49,  [1:41 remaining] 50,  [1:39 remaining] 51,\n [1:37 remaining] 52,  [1:35 remaining] 53,  [1:33 remaining] 54,\n [1:31 remaining] 55,  [1:29 remaining] 56,  [1:27 remaining] 57,\n [1:25 remaining] 58,  [1:22 remaining] 59,  [1:21 remaining] 60,\n [1:18 remaining] 61,  [1:16 remaining] 62,  [1:14 remaining] 63,\n [1:12 remaining] 64,  [1:10 remaining] 65,  [1:08 remaining] 66,\n [1:06 remaining] 67,  [1:04 remaining] 68,  [1:02 remaining] 69,\n [1:00 remaining] 70,  [58 sec remaining] 71,  [56 sec remaining] 72,\n [54 sec remaining] 73,  [52 sec remaining] 74,  [50 sec remaining] 75,\n [48 sec remaining] 76,  [46 sec remaining] 77,  [44 sec remaining] 78,\n [42 sec remaining] 79,  [40 sec remaining] 80,  [38 sec remaining] 81,\n [36 sec remaining] 82,  [34 sec remaining] 83,  [32 sec remaining] 84,\n [30 sec remaining] 85,  [28 sec remaining] 86,  [26 sec remaining] 87,\n [24 sec remaining] 88,  [22 sec remaining] 89,  [20 sec remaining] 90,\n [18 sec remaining] 91,  [16 sec remaining] 92,  [14 sec remaining] 93,\n [12 sec remaining] 94,  [10 sec remaining] 95,  [8 sec remaining] 96,\n [6 sec remaining] 97,  [4 sec remaining] 98,  [2 sec remaining] \n99.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(K_explosion.csr, . - r ~ r, xlab=\"d\", ylab=\"K(d)-r\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-105-1.png){width=672}\n:::\n:::\n\n\n### Strategic Development\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(448)\nK_Strat.csr <- envelope(conflict_sagaing_2024_ppp_list$`Strategic developments`, Kest, nsim = 99, rank = 1, glocal=TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 99 simulations of CSR  ...\n1, 2,  [3:38 remaining] 3,\n [3:10 remaining] 4,  [3:03 remaining] 5,  [3:00 remaining] 6,\n [3:00 remaining] 7,  [3:00 remaining] 8,  [2:56 remaining] 9,\n [2:51 remaining] 10,  [2:47 remaining] 11,  [2:41 remaining] 12,\n [2:39 remaining] 13,  [2:35 remaining] 14,  [2:34 remaining] 15,\n [2:32 remaining] 16,  [2:30 remaining] 17,  [2:28 remaining] 18,\n [2:25 remaining] 19,  [2:25 remaining] 20,  [2:22 remaining] 21,\n [2:21 remaining] 22,  [2:18 remaining] 23,  [2:18 remaining] 24,\n [2:16 remaining] 25,  [2:14 remaining] 26,  [2:13 remaining] 27,\n [2:10 remaining] 28,  [2:08 remaining] 29,  [2:07 remaining] 30,\n [2:05 remaining] 31,  [2:05 remaining] 32,  [2:04 remaining] 33,\n [2:03 remaining] 34,  [2:01 remaining] 35,  [1:59 remaining] 36,\n [1:57 remaining] 37,  [1:55 remaining] 38,  [1:53 remaining] 39,\n [1:51 remaining] 40,  [1:49 remaining] 41,  [1:48 remaining] 42,\n [1:45 remaining] 43,  [1:44 remaining] 44,  [1:42 remaining] 45,\n [1:41 remaining] 46,  [1:39 remaining] 47,  [1:37 remaining] 48,\n [1:35 remaining] 49,  [1:33 remaining] 50,  [1:31 remaining] 51,\n [1:29 remaining] 52,  [1:28 remaining] 53,  [1:26 remaining] 54,\n [1:24 remaining] 55,  [1:22 remaining] 56,  [1:21 remaining] 57,\n [1:19 remaining] 58,  [1:17 remaining] 59,  [1:15 remaining] 60,\n [1:13 remaining] 61,  [1:12 remaining] 62,  [1:10 remaining] 63,\n [1:08 remaining] 64,  [1:06 remaining] 65,  [1:04 remaining] 66,\n [1:03 remaining] 67,  [1:01 remaining] 68,  [59 sec remaining] 69,\n [57 sec remaining] 70,  [55 sec remaining] 71,  [54 sec remaining] 72,\n [52 sec remaining] 73,  [50 sec remaining] 74,  [48 sec remaining] 75,\n [46 sec remaining] 76,  [44 sec remaining] 77,  [42 sec remaining] 78,\n [40 sec remaining] 79,  [38 sec remaining] 80,  [36 sec remaining] 81,\n [34 sec remaining] 82,  [32 sec remaining] 83,  [31 sec remaining] 84,\n [29 sec remaining] 85,  [27 sec remaining] 86,  [25 sec remaining] 87,\n [23 sec remaining] 88,  [21 sec remaining] 89,  [19 sec remaining] 90,\n [17 sec remaining] 91,  [15 sec remaining] 92,  [13 sec remaining] 93,\n [11 sec remaining] 94,  [10 sec remaining] 95,  [8 sec remaining] 96,\n [6 sec remaining] 97,  [4 sec remaining] 98,  [2 sec remaining] \n99.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(K_Strat.csr, . - r ~ r, xlab=\"d\", ylab=\"K(d)-r\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-106-1.png){width=672}\n:::\n:::\n\n\n### Violence against civilians\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(448)\nK_violence.csr <- envelope(conflict_sagaing_2024_ppp_list$`Violence against civilians`, Kest, nsim = 99, rank = 1, glocal=TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 99 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, \n99.\n\nDone.\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(K_violence.csr, . - r ~ r, xlab=\"d\", ylab=\"K(d)-r\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-107-1.png){width=672}\n:::\n:::\n\n:::\n\nLikewise it does show that the conflicts in 2024 are all generally clustered as it is above the envelope\n\n## Insights\nOur STKDE results confirm our initial KDE results in detailing clustered conflict event happening within Sagaing. Central Myanmar is also once again shown to be filled with conflicts.",
    "supporting": [
      "Take-home_Ex01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}